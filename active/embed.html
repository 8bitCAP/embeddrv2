<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Embed</title>
	<script src="../active/uv/uv.bundle.js" defer></script>
	<script src="../active/uv/uv.config.js" defer></script>
	<link rel="icon" href="logo.png" />
	<style>
		html,
		body {
			margin: 0;
			padding: 0;
			height: 100%;
			width: 100%;
			background: #000;
		}

		iframe {
			position: absolute;
			top: 0;
			left: 0;
			width: 100vw;
			height: 100vh;
			border: none;
		}

		#logo {
			position: fixed;
			top: 10px;
			left: 10px;
			width: 120px;
			opacity: 0.5;
			z-index: 9999;
			display: none;
		}

		#form-container {
			display: flex;
			height: 100vh;
			align-items: center;
			justify-content: center;
			background: #111;
		}

		#form-container input {
			width: 400px;
			padding: 10px;
			font-size: 18px;
		}
	</style>
</head>

<body>
	<div id="form-container">
		<input type="text" id="urlInput" placeholder="Enter a URL and hit Enter...">
  </div>
		<img src="logo.png" id="logo">
		<script>
			const logo = document.getElementById('logo');
  const input = document.getElementById('urlInput');
  const container = document.getElementById('form-container');

  function pornhubdelay() {
    return new Promise((resolve) => {
      const check = () => {
        if (typeof __uv$config !== 'undefined' && typeof __uv$config.encodeUrl === 'function') {
          resolve();
        } else {
          setTimeout(check, 50);
        }
      };
      check();
    });
  }

  async function loadFromHash() {
    const url = decodeURIComponent(location.hash.slice(1));
    if (!url) return;

    container.style.display = 'none';
    logo.style.display = 'block';

    const proxyUrl = await __uv$config.encodeUrl(url);
    const iframe = document.createElement('iframe');
    iframe.src = __uv$config.prefix + proxyUrl;
    document.body.appendChild(iframe);
  }

  input.addEventListener('keypress', async (e) => {
    if (e.key === 'Enter') {
      location.hash = input.value;
      await pornhubdelay();
      loadFromHash();
    }
  });

  window.addEventListener('hashchange', async () => {
    await pornhubdelay();
    loadFromHash();
  });

  window.addEventListener('load', async () => {
    await pornhubdelay();
    loadFromHash();
  });
		</script>
</body>

</html>
